<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Playground</title>
    <script src="../jquery-1.3.2.min.js" type="text/javascript"></script>
    <style type="text/css" media="all">
    *,html,body { font:1em/1.5 verdana,tahoma,arial; }
    button { width: 10em; }
    </style>
<script type="text/javascript">
    CONST = (function() {
        function as_const(name, value) {
            return "const " + name + "=" + (
			/^(null|true|false|(\+|\-)?\d+(\.\d+)?)$/.test(value = String(value)) ? value : '"' + replace_(value) + '"'
		    )
        };
        var define_, replace_;
        replace_ = function(value) {
            var replace = { "\x08": "b", "\x0A": "\\n", "\x0B": "v", "\x0C": "f", "\x0D": "\\r", '"': '"', "\\": "\\" };
            return value.replace(/\x08|[\x0A-\x0D]|"|\\/g, function(value) { return "\\" + replace[value] })
        };
        define_ = function(name, value) {
            var script = document.createElement("script");
            script.type = "text/javascript";
            script.appendChild(document.createTextNode(as_const(name, value)));
            document.documentElement.appendChild(script);
            document.documentElement.removeChild(script);
            return define_;
        }
        /*@cc_on
        // only IE version, uses VBScript
        replace_ = function(value) {
            var replace = { "\x0A": "\\n", "\x0D": "\\r" };
            return value.replace(/"/g, '""').replace(/\n|\r/g, function(value) { return replace[value] })
        };
        define_ = this.execScript ?
		function(name, value) {
		    execScript(as_const(name, value), "VBScript");
		    return define_;
		} :
		function(name, value) {
		    eval(as_const(name, value).substring(6));
		    return define_;
		}
        @*/
        return define_;
    })();
    /*
    usage :
    CONST("Q", 4)("P", 5)("R", 6);
    */    
</script>
</head>
<body>
<script type="text/javascript">
    window.onload = function() {
    CONST("A", 1)("B", 2);
    }
</script>
</body>
</html>
